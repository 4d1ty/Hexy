name: Build Hexy Windows Release

on:
  release:
    types: [published]

jobs:
  build-windows:
    runs-on: windows-2025

    steps:
    - name: Checkout repository
      uses: actions/checkout@v3

    - name: Install MSYS2 / g++
      uses: msys2/setup-msys2@v2
      with:
        update: true
        install: mingw-w64-x86_64-gcc

    - name: Build Hexy
      run: |
        g++ -std=c++20 -Wall -O2 -o hexy.exe main.cpp

    - name: Create zip archive
      run: |
        powershell Compress-Archive -Path hexy.exe -DestinationPath hexy-windows.zip

    - name: Attach zip to release
      uses: ncipollo/release-action@v1
      with:
        artifacts: hexy-windows.zip
        tag: ${{ github.ref_name }}
